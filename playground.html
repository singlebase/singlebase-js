<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  
  <form class="upload">
    <input type="file" name="uploadFile" required />
    <input type="submit" />
 </form>



 <div>


  <input>

 </div>
  
<script type="module">
  //import createClient from './dist/esm/index.js'
  import createClient  from 'https://cdn.jsdelivr.net/npm/@singlebase/singlebase-js/+esm'

  const URL = "http://127.0.0.1:5000/api"
  //const ACCESS_KEY = "chipekj24te4lkr24ui0.04951609cab14b04bafac71afd4dae33";
  const ACCESS_KEY = "chipekj24te4lkr24ui0.04951609cab14b04bafac71afd4dae33.2ef2f047107d4160a9f311bd5d2e84a0";

  const singlebase = createClient(URL, ACCESS_KEY)
  
  const collectionName = "waitlist"

  const { data, error, ok } = await singlebase
    .collection(collectionName)
    .matches({"**": true})
    .fetch({limit: 5})
  console.log("ALL", data)

  const d1 = await singlebase
    .collection(collectionName)
    .setDoc("2af886843f234301b6eaf6114b119612", {"count:$incr": 1})
  console.log("D1", d1)

  const d2 = await singlebase
    .collection(collectionName)
    .getDoc("2af886843f234301b6eaf6114b119612")
  
  console.log("D2", d2)

const uploadForm = document.querySelector('.upload')
uploadForm.addEventListener('submit', async function(e) {
    e.preventDefault()
    let file = e.target.uploadFile.files[0]
    const {data, error} = await singlebase.storage.upload(file)
    if (data) {
      console.log("FILE UPLOADE", data)
    } else {
      console.log("FILE UPDLOAD ERROR", error)
    }
})

</script>

</body>
</html>